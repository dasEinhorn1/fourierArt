<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Fourier Art</title>
    <script src="js/jquery.min.js"></script>
    <script src="js/p5.js"></script>
    <script src="js/p5.sound.min.js"></script>
    <script src="js/paper-full.min.js"></script>
    <script src="https://use.fontawesome.com/cd94f3602e.js"></script>
    <link href="https://fonts.googleapis.com/css?family=Baloo+Bhaina" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="css/main.css"/>
  </head>
  <body>
    <header>
      <h1 class="title">Fourier Art</h1>
      <ol class="navbar">
        <li><a href="docs.html">Docs</a></li>
        <li><a href="about.html">About</a></li>
        <li><a href="index.html">Visualizer</a></li>
      </ol>
    </header>
    <main>
      <div id='load-screen' style='display:none;'>
        <img src="media/Infinity.svg" alt="loading"/>
      </div>
      <!--Two.js applies to div below-->
      <canvas id="visualizer" resize="true"></canvas>

      <!--All UI for controlling visualization-->
      <div id="vis-menu">
        <div id='queue' class="submenu">
          <div id = 'queue-controls'>
            <button class='btn btn-block circle' type="button" name="add-song">
              <i><i class="fa fa-plus" aria-hidden="true"></i></i>
            </button>
            <button class='btn btn-block' type="button" name="reorder">Edit</button>
            <button class='btn btn-block' type="button" name="remove-all">Remove</button>
          </div>
          <div class="playlist-wrapper">
            <table class='playlist'>
              <tr class='playlist-header'>
                <th>
                  <i class="fa fa-volume-up" aria-hidden="true"
                    style='visibility:hidden'></i>
                </th>
                <th>Song Title</th>
                <th>Duration</th>
              </tr>
            </table>
          </div>
          <div id="controls">
            <button id="prev-song" class='btn btn-block' type="button" name="next">
              <i class="fa fa-step-backward" aria-hidden="true"></i>
            </button>
            <div id="play-pause" class='btn btn-block circle'>
              <i class="fa fa-pause" aria-hidden="true"></i>
              <i class="fa fa-play" aria-hidden="true" style='display:none'></i>
            </div>
            <button id="next-song" class='btn btn-block' type="button" name="next">
              <i class="fa fa-step-forward" aria-hidden="true"></i>
            </button>
            <button id="repeat" class='btn btn-block' type="button" name="loop">
              <i class="fa fa-retweet" aria-hidden="true"></i>
            </button>
          </div>
        </div>
        <div id="song-add" class="submenu pop-out">
          <label for="sound-file">Upload a file:</label>
          <input id="file-input" type="file" name="sound-file" multiple='true'/>
          <label for="sound-link">Enter a Url:</label>
          <input id="link-input" type="text" name="sound-link" placeholder="www.example.com/1.mp3"/>
        </div>

    </div>
    </main>
    <footer>

    </footer>
    <script src="js/player.js"></script>
    <script src="js/fourier.js"></script>
    <script type="text/paperscript" src="js/main.js" canvas="visualizer"></script>
  </body>
  <script type="text/javascript">
    $('#file-input').change( function(event) {
      $.each(event.target.files, function(k,v) {
        var tmppath = URL.createObjectURL(v);
        q.addSong(tmppath, function(){}, v.name);
      });
    });

    $('#link-input').on('keypress', function(event) {
      if (event.which == 13) {
        console.log("adding");
        q.addSong(event.target.value, function(){});
      }
    })

    $("#next-song").click(function(e) {
      q.next();
    });
    $("#prev-song").click(function(e) {
      q.previous();
    });

    $('#repeat').click(function(e) {
      $(e.target).parent().toggleClass('selected');
      q.toggleRepeat();
    });

    $("#play-pause").click(function(e){
      var play = playButtonUpdate();
      if (play) {
        q.pause();
      } else {
        q.play();
      }
    });
    $("#songSelect").change(function(e){
      console.log($(e.target).val())
      path = "media/sound/" + $(e.target).val();
      q.addSong(path);
    });
  </script>
</html>
